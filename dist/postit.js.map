{"version":3,"sources":["manager.js"],"names":["e","exports","module","define","amd","f","window","global","self","PostIt","t","n","r","s","o","u","a","require","i","Error","call","length",1,"_dereq_","instances","Factory","create","id","instance","destroy","get","getAll","./postit",2,"helpers","Manager","add","that","this","console","error","remove","record","event","listeners","off","removeAll","records","size","on","listener","emit","target","message","origin","openWindow","options","./factory","./helpers",3,"serialize","params","_params","param","push","join","shallowMerge","destination","source","prop","nativeScreen","screen","nativeWindow","nativeDocument","document","nativeDocumentElement","documentElement","dualScreenLeft","screenLeft","left","dualScreenTop","screenTop","top","width","innerWidth","clientWidth","height","innerHeight","clientHeight","features","newWindow","open","url","title","focus",4,"token","prototype","wrapListener","evt","data","test","JSON","parse","err","dataParsed","__event","__id","__origin","indexOf","__token","addEventListener","removeEventListener","splice","eventOrigin","location","href","Object","toString","stringify","__value","postMessage"],"mappings":"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","file":"postit.js","sourcesContent":["!function(e){if(\"object\"==typeof exports)module.exports=e();else if(\"function\"==typeof define&&define.amd)define(e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.PostIt=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n'use strict';\n\nvar PostIt = _dereq_('./postit');\nvar instances = {};\n\n/**\n * Factory Module.\n * @public\n */\n\nvar Factory = module.exports = {};\n\n/**\n * Creates a `PostIt` factory (Singleton).\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nFactory.create = function (id) {\n\tvar instance = instances[id];\n\n\t// If a given `instance` is found, use it and RETURN EARLY.\n\tif (instance) {\n\t\treturn instance;\n\t}\n\n\t// Otherwise, create a new `instance` and store it.\n\treturn (instances[id] = new PostIt(id));\n};\n\n/**\n * Destroys an explicit `PostIt`, factory instance.\n * @param {string} id\n * @returns {void}\n * @public\n */\n\nFactory.destroy = function (id) {\n\tdelete instances[id];\n};\n\n/**\n * Gets an explicit `PostIt`, factory instance.\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nFactory.get = function (id) {\n\treturn instances[id];\n};\n\n/**\n * Gets all `PostIt`, factory instances.\n * @returns {object}\n * @public\n */\n\nFactory.getAll = function () {\n\treturn instances;\n};\n\n},{\"./postit\":4}],2:[function(_dereq_,module,exports){\n'use strict';\n\nvar Factory = _dereq_('./factory');\nvar helpers = _dereq_('./helpers');\n\n/**\n * Manager Module.\n * @public\n */\n\nvar Manager = module.exports = {};\n\n/**\n * Creates and manages a new `PostIt` instance.\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nManager.add = function (id) {\n\tvar that = this;\n\n\tif ('string' !== typeof id) {\n\t\tconsole.error(id + ' should be a `String`.');\n\n\t\treturn that;\n\t}\n\n\t// Create a memoized factory.\n\tFactory.create(id);\n\n\treturn that;\n};\n\n/**\n * Removes an explicit `PostIt` instance.\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nManager.remove = function (id) {\n\tvar that = this;\n\tvar record = that.get(id);\n\n\tif (!record) {\n\t\treturn that;\n\t}\n\n\t// Remove listeners to avoid memory leaks.\n\tfor (var event in record.listeners) {\n\t\trecord.off(event);\n\t}\n\n\tFactory.destroy(id);\n\n\treturn that;\n};\n\n/**\n * Removes all `PostIt` instances.\n * @return {object}\n * @public\n */\n\nManager.removeAll = function () {\n\tvar that = this;\n\tvar records = that.getAll();\n\n\tfor (var record in records) {\n\t\tthat.remove(record);\n\t}\n\n\treturn that;\n};\n\n/**\n * Returns the length of all `PostIt` instances.\n * @return {number}\n * @public\n */\n\nManager.size = function () {\n\tvar size = 0;\n\tvar records = this.getAll();\n\n\tfor (var record in records) {\n\t\tsize++;\n\t}\n\n\treturn size;\n};\n\n/**\n * Gets an explicit `PostIt` instance.\n * @param {string} id\n * @returns {object|void}\n */\n\nManager.get = function (id) {\n\treturn Factory.get(id) || console.error(id + ' does not match any `PostIt` instances.');\n};\n\n/**\n * Gets all `PostIt` instances.\n * @returns {object}\n */\n\nManager.getAll = function () {\n\treturn Factory.getAll();\n};\n\n/**\n * @see {@link postit.md#PostIt+on} for further information (signature, etc.).\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nManager.on = function (id, event, listener) {\n\tvar that = this;\n\tvar record = that.get(id);\n\n\tif (!record) {\n\t\treturn that;\n\t}\n\n\trecord.on(event, listener);\n\n\treturn that;\n};\n\n/**\n * @see {@link postit.md#PostIt+off} for further information (signature, etc.).\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nManager.off = function (id, event, listener) {\n\tvar that = this;\n\tvar record = that.get(id);\n\n\tif (!record) {\n\t\treturn that;\n\t}\n\n\trecord.off(event, listener);\n\n\treturn that;\n};\n\n/**\n * @see {@link postit.md#PostIt+emit} for further information (signature, etc.).\n * @param {string} id\n * @returns {object}\n * @public\n */\n\nManager.emit = function (id, event, target, message, origin) {\n\tvar that = this;\n\tvar record = that.get(id);\n\n\tif (!record) {\n\t\treturn that;\n\t}\n\n\trecord.emit(event, target, message, origin);\n\n\treturn that;\n};\n\n/**\n * @see {@link helpers.md#helpers.openWindow} for further information (signature, etc.).\n * @public\n */\n\nManager.openWindow = function (options) {\n\treturn helpers.openWindow(options || {});\n};\n\n},{\"./factory\":1,\"./helpers\":3}],3:[function(_dereq_,module,exports){\n'use strict';\n\n/**\n * Helpers Module.\n * @public\n */\n\nvar helpers = module.exports = {};\n\n/**\n * Serialize an object into a formatted string.\n * @param {object} params\n * @returns {string}\n * @public\n */\n\nhelpers.serialize = function (params) {\n\tvar _params = [];\n\n\tfor (var param in params) {\n\t\t_params.push(param + '=' + params[param]);\n\t}\n\n\treturn _params.join(', ');\n};\n\n/**\n * Merges a shallow `source` object into the `destination` object.\n * @param {object} destination\n * @param {object} source\n * @returns {object}\n * @public\n */\n\nhelpers.shallowMerge = function (destination, source) {\n\tfor (var prop in source) {\n\t\tif (null != source[prop]) {\n\t\t\tdestination[prop] = source[prop];\n\t\t}\n\t}\n\n\treturn destination;\n};\n\n/**\n * Loads a resource into a new browsing context (`window`).\n * @param {object} options\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Window/open|Window.open()} for more options.\n * @param {string} options.url\n * @param {string} options.title\n * @param {number} options.width\n * @param {number} options.height\n * @returns {object}\n * @public\n */\n\n/* istanbul ignore next */\nhelpers.openWindow = function (options) {\n\tvar that = this;\n\tvar nativeScreen = screen || {};\n\tvar nativeWindow = window;\n\tvar nativeDocument = document;\n\tvar nativeDocumentElement = nativeDocument.documentElement || {};\n\tvar dualScreenLeft = nativeWindow.screenLeft || nativeScreen.left || 0;\n\tvar dualScreenTop = nativeWindow.screenTop || nativeScreen.top || 0;\n\tvar width = nativeWindow.innerWidth || nativeDocumentElement.clientWidth || nativeScreen.width || 0;\n\tvar height = nativeWindow.innerHeight || nativeDocumentElement.clientHeight || nativeScreen.height || 0;\n\tvar left = ((width / 2) - (options.width / 2)) + dualScreenLeft;\n\tvar top = ((height / 2) - (options.height / 2)) + dualScreenTop;\n\tvar features = that.serialize(that.shallowMerge({\n\t\ttop: top,\n\t\tleft: left\n\t}, options));\n\tvar newWindow = nativeWindow.open(options.url, options.title, features);\n\n\tif (nativeWindow.focus) {\n\t\tnewWindow.focus();\n\t}\n\n\treturn newWindow;\n};\n\n},{}],4:[function(_dereq_,module,exports){\n'use strict';\n\n/**\n * PostIt Module.\n * @constructor\n * @param {string} id\n * @public\n */\n\nvar PostIt = module.exports = function (id) {\n\tthis.id = id;\n\tthis.token = 0;\n\tthis.listeners = {};\n};\n\n/**\n * Registers `.postMessage` event listeners.\n * @param {string} event\n * @param {function} listener\n * @returns {object}\n * @public\n */\n\nPostIt.prototype.on = function (event, listener) {\n\tvar that = this;\n\n\tthat.listeners[event] = that.listeners[event] || [];\n\n\tvar wrapListener = function (evt) {\n\t\tvar data = null;\n\n\t\tif (/__event\\s?\"/.test(evt.data)) {\n\t\t\ttry {\n\t\t\t\tdata = JSON.parse(evt.data);\n\t\t\t} catch (err) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevt.dataParsed = data;\n\t\t}\n\n\t\tif ('*' === event) {\n\t\t\treturn listener.call(this, evt);\n\t\t}\n\n\t\tif (!data ||\n\t\t\tevent !== data.__event ||\n\t\t\tthat.id !== data.__id ||\n\t\t\t'null' !== evt.origin && -1 === data.__origin.indexOf(evt.origin)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tlistener.call(this, evt);\n\t};\n\n\tlistener.__token = wrapListener.__token = that.token++;\n\n\twindow.addEventListener('message', wrapListener, false);\n\tthat.listeners[event].push(wrapListener);\n\n\treturn that;\n};\n\n/**\n * Unregisters (all | explicit) `.postMessage` event listeners.\n * @param {string} event\n * @param {function=} listener\n * @returns {object}\n * @public\n */\n\nPostIt.prototype.off = function (event, listener) {\n\tvar that = this;\n\tvar listeners = that.listeners[event] || [];\n\n\tfor (var i = 0; i < listeners.length; ++i) {\n\t\tif (!listener || listener.__token === listeners[i].__token) {\n\t\t\twindow.removeEventListener('message', listeners[i], false);\n\t\t\tlisteners.splice(i, 1);\n\n\t\t\t--i;\n\t\t}\n\t}\n\n\treturn that;\n};\n\n/**\n * Emits explicit `message` events, using the client's `.postMessage` emitter.\n * @param {string} event\n * @param {object} target\n * @param {string|array|object} message\n * @param {string} origin\n * @returns {object}\n * @public\n */\n\nPostIt.prototype.emit = function (event, target, message, origin) {\n\tvar that = this;\n\tvar eventOrigin = window.location.href;\n\n\tswitch (Object.prototype.toString.call(message)) {\n\t\tcase '[object Function]':\n\t\t\tconsole.error(message + ' should either be an `Object`, `Array` or `String`.');\n\n\t\t\treturn that;\n\n\t\tcase '[object Object]':\n\t\t\tmessage.__event = event;\n\t\t\tmessage.__id = that.id;\n\t\t\tmessage.__origin = eventOrigin;\n\t\t\tmessage = JSON.stringify(message);\n\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tmessage = JSON.stringify({\n\t\t\t\t__value: message,\n\t\t\t\t__id: that.id,\n\t\t\t\t__event: event,\n\t\t\t\t__origin: eventOrigin\n\t\t\t});\n\t}\n\n\ttarget.postMessage(message, origin);\n\n\treturn that;\n};\n\n},{}]},{},[2])\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kY29vcGVyL0Rlc2t0b3AvcG9zdGl0L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9kY29vcGVyL0Rlc2t0b3AvcG9zdGl0L2xpYi9mYWN0b3J5LmpzIiwiL1VzZXJzL2Rjb29wZXIvRGVza3RvcC9wb3N0aXQvbGliL2Zha2VfNjJlZTYwNTUuanMiLCIvVXNlcnMvZGNvb3Blci9EZXNrdG9wL3Bvc3RpdC9saWIvaGVscGVycy5qcyIsIi9Vc2Vycy9kY29vcGVyL0Rlc2t0b3AvcG9zdGl0L2xpYi9wb3N0aXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgUG9zdEl0ID0gcmVxdWlyZSgnLi9wb3N0aXQnKTtcbnZhciBpbnN0YW5jZXMgPSB7fTtcblxuLyoqXG4gKiBGYWN0b3J5IE1vZHVsZS5cbiAqIEBwdWJsaWNcbiAqL1xuXG52YXIgRmFjdG9yeSA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8qKlxuICogQ3JlYXRlcyBhIGBQb3N0SXRgIGZhY3RvcnkgKFNpbmdsZXRvbikuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbiAoaWQpIHtcblx0dmFyIGluc3RhbmNlID0gaW5zdGFuY2VzW2lkXTtcblxuXHQvLyBJZiBhIGdpdmVuIGBpbnN0YW5jZWAgaXMgZm91bmQsIHVzZSBpdCBhbmQgUkVUVVJOIEVBUkxZLlxuXHRpZiAoaW5zdGFuY2UpIHtcblx0XHRyZXR1cm4gaW5zdGFuY2U7XG5cdH1cblxuXHQvLyBPdGhlcndpc2UsIGNyZWF0ZSBhIG5ldyBgaW5zdGFuY2VgIGFuZCBzdG9yZSBpdC5cblx0cmV0dXJuIChpbnN0YW5jZXNbaWRdID0gbmV3IFBvc3RJdChpZCkpO1xufTtcblxuLyoqXG4gKiBEZXN0cm95cyBhbiBleHBsaWNpdCBgUG9zdEl0YCwgZmFjdG9yeSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAcHVibGljXG4gKi9cblxuRmFjdG9yeS5kZXN0cm95ID0gZnVuY3Rpb24gKGlkKSB7XG5cdGRlbGV0ZSBpbnN0YW5jZXNbaWRdO1xufTtcblxuLyoqXG4gKiBHZXRzIGFuIGV4cGxpY2l0IGBQb3N0SXRgLCBmYWN0b3J5IGluc3RhbmNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICogQHB1YmxpY1xuICovXG5cbkZhY3RvcnkuZ2V0ID0gZnVuY3Rpb24gKGlkKSB7XG5cdHJldHVybiBpbnN0YW5jZXNbaWRdO1xufTtcblxuLyoqXG4gKiBHZXRzIGFsbCBgUG9zdEl0YCwgZmFjdG9yeSBpbnN0YW5jZXMuXG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICogQHB1YmxpY1xuICovXG5cbkZhY3RvcnkuZ2V0QWxsID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gaW5zdGFuY2VzO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIEZhY3RvcnkgPSByZXF1aXJlKCcuL2ZhY3RvcnknKTtcbnZhciBoZWxwZXJzID0gcmVxdWlyZSgnLi9oZWxwZXJzJyk7XG5cbi8qKlxuICogTWFuYWdlciBNb2R1bGUuXG4gKiBAcHVibGljXG4gKi9cblxudmFyIE1hbmFnZXIgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vKipcbiAqIENyZWF0ZXMgYW5kIG1hbmFnZXMgYSBuZXcgYFBvc3RJdGAgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuTWFuYWdlci5hZGQgPSBmdW5jdGlvbiAoaWQpIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdGlmICgnc3RyaW5nJyAhPT0gdHlwZW9mIGlkKSB7XG5cdFx0Y29uc29sZS5lcnJvcihpZCArICcgc2hvdWxkIGJlIGEgYFN0cmluZ2AuJyk7XG5cblx0XHRyZXR1cm4gdGhhdDtcblx0fVxuXG5cdC8vIENyZWF0ZSBhIG1lbW9pemVkIGZhY3RvcnkuXG5cdEZhY3RvcnkuY3JlYXRlKGlkKTtcblxuXHRyZXR1cm4gdGhhdDtcbn07XG5cbi8qKlxuICogUmVtb3ZlcyBhbiBleHBsaWNpdCBgUG9zdEl0YCBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybnMge29iamVjdH1cbiAqIEBwdWJsaWNcbiAqL1xuXG5NYW5hZ2VyLnJlbW92ZSA9IGZ1bmN0aW9uIChpZCkge1xuXHR2YXIgdGhhdCA9IHRoaXM7XG5cdHZhciByZWNvcmQgPSB0aGF0LmdldChpZCk7XG5cblx0aWYgKCFyZWNvcmQpIHtcblx0XHRyZXR1cm4gdGhhdDtcblx0fVxuXG5cdC8vIFJlbW92ZSBsaXN0ZW5lcnMgdG8gYXZvaWQgbWVtb3J5IGxlYWtzLlxuXHRmb3IgKHZhciBldmVudCBpbiByZWNvcmQubGlzdGVuZXJzKSB7XG5cdFx0cmVjb3JkLm9mZihldmVudCk7XG5cdH1cblxuXHRGYWN0b3J5LmRlc3Ryb3koaWQpO1xuXG5cdHJldHVybiB0aGF0O1xufTtcblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBgUG9zdEl0YCBpbnN0YW5jZXMuXG4gKiBAcmV0dXJuIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuTWFuYWdlci5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciB0aGF0ID0gdGhpcztcblx0dmFyIHJlY29yZHMgPSB0aGF0LmdldEFsbCgpO1xuXG5cdGZvciAodmFyIHJlY29yZCBpbiByZWNvcmRzKSB7XG5cdFx0dGhhdC5yZW1vdmUocmVjb3JkKTtcblx0fVxuXG5cdHJldHVybiB0aGF0O1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBsZW5ndGggb2YgYWxsIGBQb3N0SXRgIGluc3RhbmNlcy5cbiAqIEByZXR1cm4ge251bWJlcn1cbiAqIEBwdWJsaWNcbiAqL1xuXG5NYW5hZ2VyLnNpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzaXplID0gMDtcblx0dmFyIHJlY29yZHMgPSB0aGlzLmdldEFsbCgpO1xuXG5cdGZvciAodmFyIHJlY29yZCBpbiByZWNvcmRzKSB7XG5cdFx0c2l6ZSsrO1xuXHR9XG5cblx0cmV0dXJuIHNpemU7XG59O1xuXG4vKipcbiAqIEdldHMgYW4gZXhwbGljaXQgYFBvc3RJdGAgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm5zIHtvYmplY3R8dm9pZH1cbiAqL1xuXG5NYW5hZ2VyLmdldCA9IGZ1bmN0aW9uIChpZCkge1xuXHRyZXR1cm4gRmFjdG9yeS5nZXQoaWQpIHx8IGNvbnNvbGUuZXJyb3IoaWQgKyAnIGRvZXMgbm90IG1hdGNoIGFueSBgUG9zdEl0YCBpbnN0YW5jZXMuJyk7XG59O1xuXG4vKipcbiAqIEdldHMgYWxsIGBQb3N0SXRgIGluc3RhbmNlcy5cbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKi9cblxuTWFuYWdlci5nZXRBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiBGYWN0b3J5LmdldEFsbCgpO1xufTtcblxuLyoqXG4gKiBAc2VlIHtAbGluayBwb3N0aXQubWQjUG9zdEl0K29ufSBmb3IgZnVydGhlciBpbmZvcm1hdGlvbiAoc2lnbmF0dXJlLCBldGMuKS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybnMge29iamVjdH1cbiAqIEBwdWJsaWNcbiAqL1xuXG5NYW5hZ2VyLm9uID0gZnVuY3Rpb24gKGlkLCBldmVudCwgbGlzdGVuZXIpIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXHR2YXIgcmVjb3JkID0gdGhhdC5nZXQoaWQpO1xuXG5cdGlmICghcmVjb3JkKSB7XG5cdFx0cmV0dXJuIHRoYXQ7XG5cdH1cblxuXHRyZWNvcmQub24oZXZlbnQsIGxpc3RlbmVyKTtcblxuXHRyZXR1cm4gdGhhdDtcbn07XG5cbi8qKlxuICogQHNlZSB7QGxpbmsgcG9zdGl0Lm1kI1Bvc3RJdCtvZmZ9IGZvciBmdXJ0aGVyIGluZm9ybWF0aW9uIChzaWduYXR1cmUsIGV0Yy4pLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICogQHB1YmxpY1xuICovXG5cbk1hbmFnZXIub2ZmID0gZnVuY3Rpb24gKGlkLCBldmVudCwgbGlzdGVuZXIpIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXHR2YXIgcmVjb3JkID0gdGhhdC5nZXQoaWQpO1xuXG5cdGlmICghcmVjb3JkKSB7XG5cdFx0cmV0dXJuIHRoYXQ7XG5cdH1cblxuXHRyZWNvcmQub2ZmKGV2ZW50LCBsaXN0ZW5lcik7XG5cblx0cmV0dXJuIHRoYXQ7XG59O1xuXG4vKipcbiAqIEBzZWUge0BsaW5rIHBvc3RpdC5tZCNQb3N0SXQrZW1pdH0gZm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24gKHNpZ25hdHVyZSwgZXRjLikuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuTWFuYWdlci5lbWl0ID0gZnVuY3Rpb24gKGlkLCBldmVudCwgdGFyZ2V0LCBtZXNzYWdlLCBvcmlnaW4pIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXHR2YXIgcmVjb3JkID0gdGhhdC5nZXQoaWQpO1xuXG5cdGlmICghcmVjb3JkKSB7XG5cdFx0cmV0dXJuIHRoYXQ7XG5cdH1cblxuXHRyZWNvcmQuZW1pdChldmVudCwgdGFyZ2V0LCBtZXNzYWdlLCBvcmlnaW4pO1xuXG5cdHJldHVybiB0aGF0O1xufTtcblxuLyoqXG4gKiBAc2VlIHtAbGluayBoZWxwZXJzLm1kI2hlbHBlcnMub3BlbldpbmRvd30gZm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24gKHNpZ25hdHVyZSwgZXRjLikuXG4gKiBAcHVibGljXG4gKi9cblxuTWFuYWdlci5vcGVuV2luZG93ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblx0cmV0dXJuIGhlbHBlcnMub3BlbldpbmRvdyhvcHRpb25zIHx8IHt9KTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogSGVscGVycyBNb2R1bGUuXG4gKiBAcHVibGljXG4gKi9cblxudmFyIGhlbHBlcnMgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vKipcbiAqIFNlcmlhbGl6ZSBhbiBvYmplY3QgaW50byBhIGZvcm1hdHRlZCBzdHJpbmcuXG4gKiBAcGFyYW0ge29iamVjdH0gcGFyYW1zXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICogQHB1YmxpY1xuICovXG5cbmhlbHBlcnMuc2VyaWFsaXplID0gZnVuY3Rpb24gKHBhcmFtcykge1xuXHR2YXIgX3BhcmFtcyA9IFtdO1xuXG5cdGZvciAodmFyIHBhcmFtIGluIHBhcmFtcykge1xuXHRcdF9wYXJhbXMucHVzaChwYXJhbSArICc9JyArIHBhcmFtc1twYXJhbV0pO1xuXHR9XG5cblx0cmV0dXJuIF9wYXJhbXMuam9pbignLCAnKTtcbn07XG5cbi8qKlxuICogTWVyZ2VzIGEgc2hhbGxvdyBgc291cmNlYCBvYmplY3QgaW50byB0aGUgYGRlc3RpbmF0aW9uYCBvYmplY3QuXG4gKiBAcGFyYW0ge29iamVjdH0gZGVzdGluYXRpb25cbiAqIEBwYXJhbSB7b2JqZWN0fSBzb3VyY2VcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuaGVscGVycy5zaGFsbG93TWVyZ2UgPSBmdW5jdGlvbiAoZGVzdGluYXRpb24sIHNvdXJjZSkge1xuXHRmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuXHRcdGlmIChudWxsICE9IHNvdXJjZVtwcm9wXSkge1xuXHRcdFx0ZGVzdGluYXRpb25bcHJvcF0gPSBzb3VyY2VbcHJvcF07XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGRlc3RpbmF0aW9uO1xufTtcblxuLyoqXG4gKiBMb2FkcyBhIHJlc291cmNlIGludG8gYSBuZXcgYnJvd3NpbmcgY29udGV4dCAoYHdpbmRvd2ApLlxuICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNcbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9XaW5kb3cvb3BlbnxXaW5kb3cub3BlbigpfSBmb3IgbW9yZSBvcHRpb25zLlxuICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMudXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy50aXRsZVxuICogQHBhcmFtIHtudW1iZXJ9IG9wdGlvbnMud2lkdGhcbiAqIEBwYXJhbSB7bnVtYmVyfSBvcHRpb25zLmhlaWdodFxuICogQHJldHVybnMge29iamVjdH1cbiAqIEBwdWJsaWNcbiAqL1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuaGVscGVycy5vcGVuV2luZG93ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXHR2YXIgbmF0aXZlU2NyZWVuID0gc2NyZWVuIHx8IHt9O1xuXHR2YXIgbmF0aXZlV2luZG93ID0gd2luZG93O1xuXHR2YXIgbmF0aXZlRG9jdW1lbnQgPSBkb2N1bWVudDtcblx0dmFyIG5hdGl2ZURvY3VtZW50RWxlbWVudCA9IG5hdGl2ZURvY3VtZW50LmRvY3VtZW50RWxlbWVudCB8fCB7fTtcblx0dmFyIGR1YWxTY3JlZW5MZWZ0ID0gbmF0aXZlV2luZG93LnNjcmVlbkxlZnQgfHwgbmF0aXZlU2NyZWVuLmxlZnQgfHwgMDtcblx0dmFyIGR1YWxTY3JlZW5Ub3AgPSBuYXRpdmVXaW5kb3cuc2NyZWVuVG9wIHx8IG5hdGl2ZVNjcmVlbi50b3AgfHwgMDtcblx0dmFyIHdpZHRoID0gbmF0aXZlV2luZG93LmlubmVyV2lkdGggfHwgbmF0aXZlRG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIHx8IG5hdGl2ZVNjcmVlbi53aWR0aCB8fCAwO1xuXHR2YXIgaGVpZ2h0ID0gbmF0aXZlV2luZG93LmlubmVySGVpZ2h0IHx8IG5hdGl2ZURvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgfHwgbmF0aXZlU2NyZWVuLmhlaWdodCB8fCAwO1xuXHR2YXIgbGVmdCA9ICgod2lkdGggLyAyKSAtIChvcHRpb25zLndpZHRoIC8gMikpICsgZHVhbFNjcmVlbkxlZnQ7XG5cdHZhciB0b3AgPSAoKGhlaWdodCAvIDIpIC0gKG9wdGlvbnMuaGVpZ2h0IC8gMikpICsgZHVhbFNjcmVlblRvcDtcblx0dmFyIGZlYXR1cmVzID0gdGhhdC5zZXJpYWxpemUodGhhdC5zaGFsbG93TWVyZ2Uoe1xuXHRcdHRvcDogdG9wLFxuXHRcdGxlZnQ6IGxlZnRcblx0fSwgb3B0aW9ucykpO1xuXHR2YXIgbmV3V2luZG93ID0gbmF0aXZlV2luZG93Lm9wZW4ob3B0aW9ucy51cmwsIG9wdGlvbnMudGl0bGUsIGZlYXR1cmVzKTtcblxuXHRpZiAobmF0aXZlV2luZG93LmZvY3VzKSB7XG5cdFx0bmV3V2luZG93LmZvY3VzKCk7XG5cdH1cblxuXHRyZXR1cm4gbmV3V2luZG93O1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBQb3N0SXQgTW9kdWxlLlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwdWJsaWNcbiAqL1xuXG52YXIgUG9zdEl0ID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaWQpIHtcblx0dGhpcy5pZCA9IGlkO1xuXHR0aGlzLnRva2VuID0gMDtcblx0dGhpcy5saXN0ZW5lcnMgPSB7fTtcbn07XG5cbi8qKlxuICogUmVnaXN0ZXJzIGAucG9zdE1lc3NhZ2VgIGV2ZW50IGxpc3RlbmVycy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFxuICogQHBhcmFtIHtmdW5jdGlvbn0gbGlzdGVuZXJcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuUG9zdEl0LnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudCwgbGlzdGVuZXIpIHtcblx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdHRoYXQubGlzdGVuZXJzW2V2ZW50XSA9IHRoYXQubGlzdGVuZXJzW2V2ZW50XSB8fCBbXTtcblxuXHR2YXIgd3JhcExpc3RlbmVyID0gZnVuY3Rpb24gKGV2dCkge1xuXHRcdHZhciBkYXRhID0gbnVsbDtcblxuXHRcdGlmICgvX19ldmVudFxccz9cIi8udGVzdChldnQuZGF0YSkpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGV2dC5kYXRhKTtcblx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGV2dC5kYXRhUGFyc2VkID0gZGF0YTtcblx0XHR9XG5cblx0XHRpZiAoJyonID09PSBldmVudCkge1xuXHRcdFx0cmV0dXJuIGxpc3RlbmVyLmNhbGwodGhpcywgZXZ0KTtcblx0XHR9XG5cblx0XHRpZiAoIWRhdGEgfHxcblx0XHRcdGV2ZW50ICE9PSBkYXRhLl9fZXZlbnQgfHxcblx0XHRcdHRoYXQuaWQgIT09IGRhdGEuX19pZCB8fFxuXHRcdFx0J251bGwnICE9PSBldnQub3JpZ2luICYmIC0xID09PSBkYXRhLl9fb3JpZ2luLmluZGV4T2YoZXZ0Lm9yaWdpbilcblx0XHQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRsaXN0ZW5lci5jYWxsKHRoaXMsIGV2dCk7XG5cdH07XG5cblx0bGlzdGVuZXIuX190b2tlbiA9IHdyYXBMaXN0ZW5lci5fX3Rva2VuID0gdGhhdC50b2tlbisrO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgd3JhcExpc3RlbmVyLCBmYWxzZSk7XG5cdHRoYXQubGlzdGVuZXJzW2V2ZW50XS5wdXNoKHdyYXBMaXN0ZW5lcik7XG5cblx0cmV0dXJuIHRoYXQ7XG59O1xuXG4vKipcbiAqIFVucmVnaXN0ZXJzIChhbGwgfCBleHBsaWNpdCkgYC5wb3N0TWVzc2FnZWAgZXZlbnQgbGlzdGVuZXJzLlxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uPX0gbGlzdGVuZXJcbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuUG9zdEl0LnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnQsIGxpc3RlbmVyKSB7XG5cdHZhciB0aGF0ID0gdGhpcztcblx0dmFyIGxpc3RlbmVycyA9IHRoYXQubGlzdGVuZXJzW2V2ZW50XSB8fCBbXTtcblxuXHRmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7ICsraSkge1xuXHRcdGlmICghbGlzdGVuZXIgfHwgbGlzdGVuZXIuX190b2tlbiA9PT0gbGlzdGVuZXJzW2ldLl9fdG9rZW4pIHtcblx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXJzW2ldLCBmYWxzZSk7XG5cdFx0XHRsaXN0ZW5lcnMuc3BsaWNlKGksIDEpO1xuXG5cdFx0XHQtLWk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoYXQ7XG59O1xuXG4vKipcbiAqIEVtaXRzIGV4cGxpY2l0IGBtZXNzYWdlYCBldmVudHMsIHVzaW5nIHRoZSBjbGllbnQncyBgLnBvc3RNZXNzYWdlYCBlbWl0dGVyLlxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZ3xhcnJheXxvYmplY3R9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBvcmlnaW5cbiAqIEByZXR1cm5zIHtvYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuUG9zdEl0LnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGV2ZW50LCB0YXJnZXQsIG1lc3NhZ2UsIG9yaWdpbikge1xuXHR2YXIgdGhhdCA9IHRoaXM7XG5cdHZhciBldmVudE9yaWdpbiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXG5cdHN3aXRjaCAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG1lc3NhZ2UpKSB7XG5cdFx0Y2FzZSAnW29iamVjdCBGdW5jdGlvbl0nOlxuXHRcdFx0Y29uc29sZS5lcnJvcihtZXNzYWdlICsgJyBzaG91bGQgZWl0aGVyIGJlIGFuIGBPYmplY3RgLCBgQXJyYXlgIG9yIGBTdHJpbmdgLicpO1xuXG5cdFx0XHRyZXR1cm4gdGhhdDtcblxuXHRcdGNhc2UgJ1tvYmplY3QgT2JqZWN0XSc6XG5cdFx0XHRtZXNzYWdlLl9fZXZlbnQgPSBldmVudDtcblx0XHRcdG1lc3NhZ2UuX19pZCA9IHRoYXQuaWQ7XG5cdFx0XHRtZXNzYWdlLl9fb3JpZ2luID0gZXZlbnRPcmlnaW47XG5cdFx0XHRtZXNzYWdlID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG5cblx0XHRcdGJyZWFrO1xuXG5cdFx0ZGVmYXVsdDpcblx0XHRcdG1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdF9fdmFsdWU6IG1lc3NhZ2UsXG5cdFx0XHRcdF9faWQ6IHRoYXQuaWQsXG5cdFx0XHRcdF9fZXZlbnQ6IGV2ZW50LFxuXHRcdFx0XHRfX29yaWdpbjogZXZlbnRPcmlnaW5cblx0XHRcdH0pO1xuXHR9XG5cblx0dGFyZ2V0LnBvc3RNZXNzYWdlKG1lc3NhZ2UsIG9yaWdpbik7XG5cblx0cmV0dXJuIHRoYXQ7XG59O1xuIl19\n(2)\n});\n"],"sourceRoot":"/source/"}